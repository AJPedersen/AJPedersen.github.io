---
layout: post
title: DIGHT350
permalink: dight350-030116
---

###PDO Intermediates

PHP Data Object

Make the input secure! Clean it up! Never trust user input!

####Prepared statements

1. Secure
2. Multiple executions per statement


Reduces parsing time as the preparation on the query is done only once.

Bound parameters (pass variable info to queries and run it separately from each other) minimize bandwidth to the server as you need send only the parameters each time, and not the whole query.

Prepared statements are very useful against SQL injections, as they are transmitted later using a different protocol.


Current PDO understanding:

`$results = $db->query($query_string);`

This runs right away without escaping (removing odd characters/filtering it).

When you talk to database before you have direct access to results you have access to statements.


`$statement = $db->prepare($query_string);`

Parses but doesn't run. Any syntax error and will not run. Pre execution step; preparing, not talking to database.

`$statement->execute();`

This runs the query. Adds a step, but necessary for security.

####Bound parameters = Query variables

```
SELECT name,type,creator,effect
FROM enchanted_items
WHERE creator = ?
ORDER BY ?
```

? are variables.


Defining the variables:

1. `$statement->bindParam(1, $creator);`
    - This is variable 1, after WHERE
2. `$statement->bindParam(2, $orderBy);`
    - This is variable 1, after WHERE

Bind the parameters before executing.... so they don't escape.

Here's another way to do this (and _better_ since 
you don't have to write as much code.):

```
$statement->exec(
    array(
        $creator,
        $orderBy
    )
);
```


####Defining parameters

Named parameters:

This is _best practice_.

```
SELECT name,type,creator,effect
FROM enchanted_items
WHERE creator = :creator
ORDER BY :orderBy
```


`$statement->bindParam(':creator', $creator);`

So instead of just being ? you can name the variable after the `:`. Better to use this since then code readability increases.

```
$statement->exec(
    array(
        "creator" => $creator,
        "orderBy" => $orderBy
    )
);
```

The `:` does not pass through to the array, just the `bindParam`

Most people write more variables in the `exec` array and don't use the `bindParam` since then you don't have to write as much code. 


