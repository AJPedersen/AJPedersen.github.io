---
layout: post
title: DIGHT350
permalink: dight350-022416
---

###PHP data object (PDO)

Connection between PHP script and a database server, oh boy! PDO = class (blueprint for object).

####Syntax

```
$db = new PDO(
    'mysql:host=localhost;dbname=databaseName',
    'username',
    'password'
);
```

`new` = creating new object

Can run PDOs through any almost any modern database.

`'mysql:host=localhost;dbname=databaseName'` = connecting to the database, points to where the database is located at

`var_dump(variableName)` = used for debugging, tells you everything about the variable.


####Try catch

Try catch block will let server try something, and if there's an error it will return it to you. That way you can see what is broken and catch it so you can fix it. Gotta catch 'em all!

```
try {
    // code that you are wanting to execute
} catch (Exception $error) {
    // code to run in the case of an error
}
```

`Exception` = Class; creates new 'Exception' object.

```
// set the error mode explicitly
$db->setAttribute(
    PDO::ATTR_ERRMODE,
    PDO::ERRMODE_EXCEPTION,
    echo "Your message here";
); 
```

`::` = Indicates straight from class without an object instance.
`$error->getMessage()` = Gets error message
`echo` = Displays message

Sometimes you can tell the program how to manage errors. Don't set this to 'silent' otherwise you will not know when you have errors-bad. You can manually change this to show with:

```
    PDO::ATTR_ERRMODE,
    PDO::ERRMODE_EXCEPTION,
```

`PDO` = the 'PDO' class.
`::` = this is a class, Im accessing something inside this class.
`ATTR_ERRMODE` and `ERRMODE_EXCEPTION` = attributes of the class.

Also, you can 'chain' catches together to catch or specify special messages for specific errors.

####PDO statement

A prepared statement and, after the statement is executed, an associated result set. Basically, talking to the database and getting a response.

```
$results = $db->query(
    "SQL QUERY GOES HERE"
);
```


####Fetching fetchers

1. `fetchAll()` 
    - Returns an array containing all of the result set rows.

#####Fetch style

Set the style as an argument in the `fetchAll(argumentHere)`

1. `PDO::FETCH_BOTH`
    - The DEFAULT
    - Returns an array indexed by both column name and 0-indexed column number returned in your result set.
2. `PDO::FETCH_ASSOC`
    - Returns an array indexed by column name as returned in your result set. Most helpful.
3. `PDO::FETCH_NUM`
    - Returns an array indexed by column number as returned in your result set, starting at column 0. Less helpful because it doesn't return names of your fields.

Can explicitly set the fetch type in the `setAttribute()` variable so you don't have to manually set it everytime:

```
$db->setAttribute(
    PDO::ATTR_DEFAULT_FETCH_MODE,
    PDO::FETCH_ASSOC
);
```


####Array info

Accessing info in an array:

```
foreach($results as $record):
    ...
endforeach;
```

Can be changed to use a `while` loop:

```
while($record = $results->fetch()): // As long as you can fetch a new piece of data, do so, store it in $results
    ...
endwhile;
```







